import trino
from trino import transaction
import pandas as pd
import psycopg2
from sqlalchemy import create_engine

def trino_conn():
    conn = trino.dbapi.connect(
        host = 'trino.cnio.local',
        port = 80,
        user = 'root',
        catalog = 'hive',
        schema = 'cnio',
        isolation_level = transaction.IsolationLevel.READ_COMMITTED
    )
    return conn


def trino_execute(conn,sql):
    cursor = conn.cursor()
    cursor.execute(sql)
    des = cursor.description
    data = cursor.fetchmany(size = 3)
    #data = cursor.fetchall()
    data = pd.DataFrame(data)

    colname=[]
    for item in des:
        colname.append(item[0])
    data.columns=colname

    cursor.close()
    conn.close()
    return data


def postgre_expert(data1):
    engine = create_engine('postgresql://expert-system:YJY_exp#exp502@10.1.77.51:5432/expert-system')
    data1.to_sql("pm_4g_zdy_hour",engine,schema="cnio",  index=False, if_exists='append')


if __name__ == '__main__':
    conn = trino_conn()
    sql_hour  = '''select
    PROVINCE_ID   as province_id,
    cast(CITY_ID as int)  as city_id,
    CITY_NAME as city_name,
    SERVERID as serverid,
    cast(START_TIME as timestamp)  as start_time,
    SBNID as sbnid,
    IP as ip,
    cast(OID as int)  as oid,
    RELATED_GNB as related_gnb,
    cast(CELLID as int)  as cellid,
    CELL_NAME as cell_name,
    cast(VENDOR_ID as int)  as vendor_id,
    NETWORK_TYPE as network_type,
    coalesce(cast (if(kpi_0000000001='','0',kpi_0000000001) as double ),0) as kpi_0000000001,
    coalesce(cast (if(kpi_0000000008='','0',kpi_0000000008) as double ),0) as kpi_0000000008,
    coalesce(cast (if(kpi_0000000015='','0',kpi_0000000015) as double ),0) as kpi_0000000015,
    coalesce(cast (if(kpi_0000000021='','0',kpi_0000000021) as double ),0) as kpi_0000000021,
    coalesce(cast (if(kpi_0000000027='','0',kpi_0000000027) as double ),0) as kpi_0000000027,
    coalesce(cast (if(kpi_0000000028='','0',kpi_0000000028) as double ),0) as kpi_0000000028,
    coalesce(cast (if(kpi_0000000029='','0',kpi_0000000029) as double ),0) as kpi_0000000029,
    coalesce(cast (if(kpi_0000000030='','0',kpi_0000000030) as double ),0) as kpi_0000000030,
    coalesce(cast (if(kpi_0000000031='','0',kpi_0000000031) as double ),0) as kpi_0000000031,
    coalesce(cast (if(kpi_0000000032='','0',kpi_0000000032) as double ),0) as kpi_0000000032,
    coalesce(cast (if(kpi_0000000033='','0',kpi_0000000033) as double ),0) as kpi_0000000033,
    coalesce(cast (if(kpi_0000000034='','0',kpi_0000000034) as double ),0) as kpi_0000000034,
    coalesce(cast (if(kpi_0000000035='','0',kpi_0000000035) as double ),0) as kpi_0000000035,
    coalesce(cast (if(kpi_0000000036='','0',kpi_0000000036) as double ),0) as kpi_0000000036,
    coalesce(cast (if(kpi_0000000037='','0',kpi_0000000037) as double ),0) as kpi_0000000037,
    coalesce(cast (if(kpi_0000000038='','0',kpi_0000000038) as double ),0) as kpi_0000000038,
    coalesce(cast (if(kpi_0000000039='','0',kpi_0000000039) as double ),0) as kpi_0000000039,
    coalesce(cast (if(kpi_0000000040='','0',kpi_0000000040) as double ),0) as kpi_0000000040,
    coalesce(cast (if(kpi_0000000041='','0',kpi_0000000041) as double ),0) as kpi_0000000041,
    coalesce(cast (if(kpi_0000000042='','0',kpi_0000000042) as double ),0) as kpi_0000000042,
    coalesce(cast (if(kpi_0000000043='','0',kpi_0000000043) as double ),0) as kpi_0000000043,
    coalesce(cast (if(kpi_0000000044='','0',kpi_0000000044) as double ),0) as kpi_0000000044,
    coalesce(cast (if(kpi_0000000045='','0',kpi_0000000045) as double ),0) as kpi_0000000045,
    coalesce(cast (if(kpi_0000000046='','0',kpi_0000000046) as double ),0) as kpi_0000000046,
    coalesce(cast (if(kpi_0000000047='','0',kpi_0000000047) as double ),0) as kpi_0000000047,
    coalesce(cast (if(kpi_0000000047_pucch='','0',kpi_0000000047_pucch) as double ),0) as kpi_0000000047_pucch,
    coalesce(cast (if(kpi_0000000047_srs='','0',kpi_0000000047_srs) as double ),0) as kpi_0000000047_srs,
    coalesce(cast (if(kpi_0000000047_userspace='','0',kpi_0000000047_userspace) as double ),0) as kpi_0000000047_userspace,
    coalesce(cast (if(kpi_0000000048='','0',kpi_0000000048) as double ),0) as kpi_0000000048,
    coalesce(cast (if(kpi_0000000049='','0',kpi_0000000049) as double ),0) as kpi_0000000049,
    coalesce(cast (if(kpi_0000000050='','0',kpi_0000000050) as double ),0) as kpi_0000000050,
    coalesce(cast (if(kpi_0000000051='','0',kpi_0000000051) as double ),0) as kpi_0000000051,
    coalesce(cast (if(kpi_0000000055='','0',kpi_0000000055) as double ),0) as kpi_0000000055,
    coalesce(cast (if(kpi_0000000060='','0',kpi_0000000060) as double ),0) as kpi_0000000060,
    coalesce(cast (if(kpi_0000000061='','0',kpi_0000000061) as double ),0) as kpi_0000000061,
    coalesce(cast (if(kpi_0000000065='','0',kpi_0000000065) as double ),0) as kpi_0000000065,
    coalesce(cast (if(kpi_0000000071='','0',kpi_0000000071) as double ),0) as kpi_0000000071,
    coalesce(cast (if(kpi_0000000075='','0',kpi_0000000075) as double ),0) as kpi_0000000075,
    coalesce(cast (if(kpi_0000000081='','0',kpi_0000000081) as double ),0) as kpi_0000000081,
    coalesce(cast (if(kpi_0000000085='','0',kpi_0000000085) as double ),0) as kpi_0000000085,
    coalesce(cast (if(kpi_0000000090='','0',kpi_0000000090) as double ),0) as kpi_0000000090,
    coalesce(cast (if(kpi_0000000121='','0',kpi_0000000121) as double ),0) as kpi_0000000121,
    coalesce(cast (if(kpi_0000000122='','0',kpi_0000000122) as double ),0) as kpi_0000000122,
    coalesce(cast (if(kpi_0000000123='','0',kpi_0000000123) as double ),0) as kpi_0000000123,
    coalesce(cast (if(kpi_0000000133='','0',kpi_0000000133) as double ),0) as kpi_0000000133,
    coalesce(cast (if(kpi_0000000134='','0',kpi_0000000134) as double ),0) as kpi_0000000134,
    coalesce(cast (if(kpi_0000000138='','0',kpi_0000000138) as double ),0) as kpi_0000000138,
    coalesce(cast (if(kpi_0000000143='','0',kpi_0000000143) as double ),0) as kpi_0000000143,
    coalesce(cast (if(kpi_0000000144='','0',kpi_0000000144) as double ),0) as kpi_0000000144,
    coalesce(cast (if(kpi_0000000148='','0',kpi_0000000148) as double ),0) as kpi_0000000148,
    coalesce(cast (if(kpi_0000000153='','0',kpi_0000000153) as double ),0) as kpi_0000000153,
    coalesce(cast (if(kpi_0000000153_v='','0',kpi_0000000153_v) as double ),0) as kpi_0000000153_v,
    coalesce(cast (if(kpi_0000000154='','0',kpi_0000000154) as double ),0) as kpi_0000000154,
    coalesce(cast (if(kpi_0000000155='','0',kpi_0000000155) as double ),0) as kpi_0000000155,
    coalesce(cast (if(kpi_0000000156='','0',kpi_0000000156) as double ),0) as kpi_0000000156,
    coalesce(cast (if(kpi_0000000157='','0',kpi_0000000157) as double ),0) as kpi_0000000157,
    coalesce(cast (if(kpi_0000000158='','0',kpi_0000000158) as double ),0) as kpi_0000000158,
    coalesce(cast (if(kpi_0000000158_v='','0',kpi_0000000158_v) as double ),0) as kpi_0000000158_v,
    coalesce(cast (if(kpi_0000000159='','0',kpi_0000000159) as double ),0) as kpi_0000000159,
    coalesce(cast (if(kpi_0000000160='','0',kpi_0000000160) as double ),0) as kpi_0000000160,
    coalesce(cast (if(kpi_0000000161='','0',kpi_0000000161) as double ),0) as kpi_0000000161,
    coalesce(cast (if(kpi_0000000162='','0',kpi_0000000162) as double ),0) as kpi_0000000162,
    coalesce(cast (if(kpi_0000000163='','0',kpi_0000000163) as double ),0) as kpi_0000000163,
    coalesce(cast (if(kpi_0000000164='','0',kpi_0000000164) as double ),0) as kpi_0000000164,
    coalesce(cast (if(kpi_0000000165='','0',kpi_0000000165) as double ),0) as kpi_0000000165,
    coalesce(cast (if(kpi_0000000166='','0',kpi_0000000166) as double ),0) as kpi_0000000166,
    coalesce(cast (if(kpi_0000000167='','0',kpi_0000000167) as double ),0) as kpi_0000000167,
    coalesce(cast (if(kpi_0000000168='','0',kpi_0000000168) as double ),0) as kpi_0000000168,
    coalesce(cast (if(kpi_0000000169='','0',kpi_0000000169) as double ),0) as kpi_0000000169,
    coalesce(cast (if(kpi_0000000170='','0',kpi_0000000170) as double ),0) as kpi_0000000170,
    coalesce(cast (if(kpi_0000000171='','0',kpi_0000000171) as double ),0) as kpi_0000000171,
    coalesce(cast (if(kpi_0000000172='','0',kpi_0000000172) as double ),0) as kpi_0000000172,
    coalesce(cast (if(kpi_0000000176='','0',kpi_0000000176) as double ),0) as kpi_0000000176,
    coalesce(cast (if(kpi_0000000181='','0',kpi_0000000181) as double ),0) as kpi_0000000181,
    coalesce(cast (if(kpi_0000000181_hofailure='','0',kpi_0000000181_hofailure) as double ),0) as kpi_0000000181_hofailure,
    coalesce(cast (if(kpi_0000000182='','0',kpi_0000000182) as double ),0) as kpi_0000000182,
    coalesce(cast (if(kpi_0000000186='','0',kpi_0000000186) as double ),0) as kpi_0000000186,
    coalesce(cast (if(kpi_0000000191='','0',kpi_0000000191) as double ),0) as kpi_0000000191,
    coalesce(cast (if(kpi_0000000192='','0',kpi_0000000192) as double ),0) as kpi_0000000192,
    coalesce(cast (if(kpi_0000000193='','0',kpi_0000000193) as double ),0) as kpi_0000000193,
    coalesce(cast (if(kpi_0000000194='','0',kpi_0000000194) as double ),0) as kpi_0000000194,
    coalesce(cast (if(kpi_0000000195='','0',kpi_0000000195) as double ),0) as kpi_0000000195,
    coalesce(cast (if(kpi_0000000196='','0',kpi_0000000196) as double ),0) as kpi_0000000196,
    coalesce(cast (if(kpi_0000000197='','0',kpi_0000000197) as double ),0) as kpi_0000000197,
    coalesce(cast (if(kpi_0000000198='','0',kpi_0000000198) as double ),0) as kpi_0000000198,
    coalesce(cast (if(kpi_0000000199='','0',kpi_0000000199) as double ),0) as kpi_0000000199,
    coalesce(cast (if(kpi_0000000200='','0',kpi_0000000200) as double ),0) as kpi_0000000200,
    coalesce(cast (if(kpi_0000000201='','0',kpi_0000000201) as double ),0) as kpi_0000000201,
    coalesce(cast (if(kpi_0000000205='','0',kpi_0000000205) as double ),0) as kpi_0000000205,
    coalesce(cast (if(kpi_0000000210='','0',kpi_0000000210) as double ),0) as kpi_0000000210,
    coalesce(cast (if(kpi_0000000220='','0',kpi_0000000220) as double ),0) as kpi_0000000220,
    coalesce(cast (if(kpi_0000000220_rnl='','0',kpi_0000000220_rnl) as double ),0) as kpi_0000000220_rnl,
    coalesce(cast (if(kpi_0000000221='','0',kpi_0000000221) as double ),0) as kpi_0000000221,
    coalesce(cast (if(kpi_0000000222='','0',kpi_0000000222) as double ),0) as kpi_0000000222,
    coalesce(cast (if(kpi_0000000223='','0',kpi_0000000223) as double ),0) as kpi_0000000223,
    coalesce(cast (if(kpi_0000000224='','0',kpi_0000000224) as double ),0) as kpi_0000000224,
    coalesce(cast (if(kpi_0000000225='','0',kpi_0000000225) as double ),0) as kpi_0000000225,
    coalesce(cast (if(kpi_0000000226='','0',kpi_0000000226) as double ),0) as kpi_0000000226,
    coalesce(cast (if(kpi_0000000227='','0',kpi_0000000227) as double ),0) as kpi_0000000227,
    coalesce(cast (if(kpi_0000000228='','0',kpi_0000000228) as double ),0) as kpi_0000000228,
    coalesce(cast (if(kpi_0000000228_v='','0',kpi_0000000228_v) as double ),0) as kpi_0000000228_v,
    coalesce(cast (if(kpi_0000000229='','0',kpi_0000000229) as double ),0) as kpi_0000000229,
    coalesce(cast (if(kpi_0000000229_v='','0',kpi_0000000229_v) as double ),0) as kpi_0000000229_v,
    coalesce(cast (if(kpi_0000000230='','0',kpi_0000000230) as double ),0) as kpi_0000000230,
    coalesce(cast (if(kpi_0000000230_v='','0',kpi_0000000230_v) as double ),0) as kpi_0000000230_v,
    coalesce(cast (if(kpi_0000000231='','0',kpi_0000000231) as double ),0) as kpi_0000000231,
    coalesce(cast (if(kpi_0000000231_v='','0',kpi_0000000231_v) as double ),0) as kpi_0000000231_v,
    coalesce(cast (if(kpi_0000000232='','0',kpi_0000000232) as double ),0) as kpi_0000000232,
    coalesce(cast (if(kpi_0000000233='','0',kpi_0000000233) as double ),0) as kpi_0000000233,
    coalesce(cast (if(kpi_0000000237='','0',kpi_0000000237) as double ),0) as kpi_0000000237,
    coalesce(cast (if(kpi_0000000242='','0',kpi_0000000242) as double ),0) as kpi_0000000242,
    coalesce(cast (if(kpi_0000000243='','0',kpi_0000000243) as double ),0) as kpi_0000000243,
    coalesce(cast (if(kpi_0000000247='','0',kpi_0000000247) as double ),0) as kpi_0000000247,
    coalesce(cast (if(kpi_0000000252='','0',kpi_0000000252) as double ),0) as kpi_0000000252,
    coalesce(cast (if(kpi_0000000253='','0',kpi_0000000253) as double ),0) as kpi_0000000253,
    coalesce(cast (if(kpi_0000000257='','0',kpi_0000000257) as double ),0) as kpi_0000000257,
    coalesce(cast (if(kpi_0000000262='','0',kpi_0000000262) as double ),0) as kpi_0000000262,
    coalesce(cast (if(kpi_0000000263='','0',kpi_0000000263) as double ),0) as kpi_0000000263,
    coalesce(cast (if(kpi_0000000267='','0',kpi_0000000267) as double ),0) as kpi_0000000267,
    coalesce(cast (if(kpi_0000000272='','0',kpi_0000000272) as double ),0) as kpi_0000000272,
    coalesce(cast (if(kpi_0000000273='','0',kpi_0000000273) as double ),0) as kpi_0000000273,
    coalesce(cast (if(kpi_0000000274='','0',kpi_0000000274) as double ),0) as kpi_0000000274,
    coalesce(cast (if(kpi_0000000275='','0',kpi_0000000275) as double ),0) as kpi_0000000275,
    coalesce(cast (if(kpi_0000000276='','0',kpi_0000000276) as double ),0) as kpi_0000000276,
    coalesce(cast (if(kpi_0000000277='','0',kpi_0000000277) as double ),0) as kpi_0000000277,
    coalesce(cast (if(kpi_0000000278='','0',kpi_0000000278) as double ),0) as kpi_0000000278,
    coalesce(cast (if(kpi_0000000279='','0',kpi_0000000279) as double ),0) as kpi_0000000279,
    coalesce(cast (if(kpi_0000000280='','0',kpi_0000000280) as double ),0) as kpi_0000000280,
    coalesce(cast (if(kpi_0000000281='','0',kpi_0000000281) as double ),0) as kpi_0000000281,
    coalesce(cast (if(kpi_0000000282='','0',kpi_0000000282) as double ),0) as kpi_0000000282,
    coalesce(cast (if(kpi_0000000283='','0',kpi_0000000283) as double ),0) as kpi_0000000283,
    coalesce(cast (if(kpi_0000000284='','0',kpi_0000000284) as double ),0) as kpi_0000000284,
    coalesce(cast (if(kpi_0000000285='','0',kpi_0000000285) as double ),0) as kpi_0000000285,
    coalesce(cast (if(kpi_0000000286='','0',kpi_0000000286) as double ),0) as kpi_0000000286,
    coalesce(cast (if(kpi_0000000287='','0',kpi_0000000287) as double ),0) as kpi_0000000287,
    coalesce(cast (if(kpi_0000000288='','0',kpi_0000000288) as double ),0) as kpi_0000000288,
    coalesce(cast (if(kpi_0000000289='','0',kpi_0000000289) as double ),0) as kpi_0000000289,
    coalesce(cast (if(kpi_0000000290='','0',kpi_0000000290) as double ),0) as kpi_0000000290,
    coalesce(cast (if(kpi_0000000291='','0',kpi_0000000291) as double ),0) as kpi_0000000291,
    coalesce(cast (if(kpi_0000000292='','0',kpi_0000000292) as double ),0) as kpi_0000000292,
    coalesce(cast (if(kpi_0000000293='','0',kpi_0000000293) as double ),0) as kpi_0000000293,
    coalesce(cast (if(kpi_0000000294='','0',kpi_0000000294) as double ),0) as kpi_0000000294,
    coalesce(cast (if(kpi_0000000295='','0',kpi_0000000295) as double ),0) as kpi_0000000295,
    coalesce(cast (if(kpi_0000000296='','0',kpi_0000000296) as double ),0) as kpi_0000000296,
    coalesce(cast (if(kpi_0000000297='','0',kpi_0000000297) as double ),0) as kpi_0000000297,
    coalesce(cast (if(kpi_0000000298='','0',kpi_0000000298) as double ),0) as kpi_0000000298,
    coalesce(cast (if(kpi_0000000299='','0',kpi_0000000299) as double ),0) as kpi_0000000299,
    coalesce(cast (if(kpi_0000000300='','0',kpi_0000000300) as double ),0) as kpi_0000000300,
    coalesce(cast (if(kpi_0000000301='','0',kpi_0000000301) as double ),0) as kpi_0000000301,
    coalesce(cast (if(kpi_0000000302='','0',kpi_0000000302) as double ),0) as kpi_0000000302,
    coalesce(cast (if(kpi_0000000303='','0',kpi_0000000303) as double ),0) as kpi_0000000303,
    coalesce(cast (if(kpi_0000000304='','0',kpi_0000000304) as double ),0) as kpi_0000000304,
    coalesce(cast (if(kpi_0000000305='','0',kpi_0000000305) as double ),0) as kpi_0000000305,
    coalesce(cast (if(kpi_0000000306='','0',kpi_0000000306) as double ),0) as kpi_0000000306,
    coalesce(cast (if(kpi_0000000307='','0',kpi_0000000307) as double ),0) as kpi_0000000307,
    coalesce(cast (if(kpi_0000000308='','0',kpi_0000000308) as double ),0) as kpi_0000000308,
    coalesce(cast (if(kpi_0000000309='','0',kpi_0000000309) as double ),0) as kpi_0000000309,
    coalesce(cast (if(kpi_0000000310='','0',kpi_0000000310) as double ),0) as kpi_0000000310,
    coalesce(cast (if(kpi_0000000311='','0',kpi_0000000311) as double ),0) as kpi_0000000311,
    coalesce(cast (if(kpi_0000000312='','0',kpi_0000000312) as double ),0) as kpi_0000000312,
    coalesce(cast (if(kpi_0000000313='','0',kpi_0000000313) as double ),0) as kpi_0000000313,
    coalesce(cast (if(kpi_0000000314='','0',kpi_0000000314) as double ),0) as kpi_0000000314,
    coalesce(cast (if(kpi_0000000315='','0',kpi_0000000315) as double ),0) as kpi_0000000315,
    coalesce(cast (if(kpi_0000000316='','0',kpi_0000000316) as double ),0) as kpi_0000000316,
    coalesce(cast (if(kpi_0000000317='','0',kpi_0000000317) as double ),0) as kpi_0000000317,
    coalesce(cast (if(kpi_0000000318='','0',kpi_0000000318) as double ),0) as kpi_0000000318,
    coalesce(cast (if(kpi_0000000319='','0',kpi_0000000319) as double ),0) as kpi_0000000319,
    coalesce(cast (if(kpi_0000000320='','0',kpi_0000000320) as double ),0) as kpi_0000000320,
    coalesce(cast (if(kpi_0000000321='','0',kpi_0000000321) as double ),0) as kpi_0000000321,
    coalesce(cast (if(kpi_0000000322='','0',kpi_0000000322) as double ),0) as kpi_0000000322,
    coalesce(cast (if(kpi_0000000323='','0',kpi_0000000323) as double ),0) as kpi_0000000323,
    coalesce(cast (if(kpi_0000000324='','0',kpi_0000000324) as double ),0) as kpi_0000000324,
    coalesce(cast (if(kpi_0000000325='','0',kpi_0000000325) as double ),0) as kpi_0000000325,
    coalesce(cast (if(kpi_0000000326='','0',kpi_0000000326) as double ),0) as kpi_0000000326,
    coalesce(cast (if(kpi_0000000327='','0',kpi_0000000327) as double ),0) as kpi_0000000327,
    coalesce(cast (if(kpi_0000000328='','0',kpi_0000000328) as double ),0) as kpi_0000000328,
    coalesce(cast (if(kpi_0000000329='','0',kpi_0000000329) as double ),0) as kpi_0000000329,
    coalesce(cast (if(kpi_0000000330='','0',kpi_0000000330) as double ),0) as kpi_0000000330,
    coalesce(cast (if(kpi_0000000331='','0',kpi_0000000331) as double ),0) as kpi_0000000331,
    coalesce(cast (if(kpi_0000000332='','0',kpi_0000000332) as double ),0) as kpi_0000000332,
    coalesce(cast (if(kpi_0000000336='','0',kpi_0000000336) as double ),0) as kpi_0000000336,
    coalesce(cast (if(kpi_0000000342='','0',kpi_0000000342) as double ),0) as kpi_0000000342,
    coalesce(cast (if(kpi_0000000346='','0',kpi_0000000346) as double ),0) as kpi_0000000346,
    coalesce(cast (if(kpi_0000000352='','0',kpi_0000000352) as double ),0) as kpi_0000000352,
    coalesce(cast (if(kpi_0000000356='','0',kpi_0000000356) as double ),0) as kpi_0000000356,
    coalesce(cast (if(kpi_0000000362='','0',kpi_0000000362) as double ),0) as kpi_0000000362,
    coalesce(cast (if(kpi_0000000366='','0',kpi_0000000366) as double ),0) as kpi_0000000366,
    coalesce(cast (if(kpi_0000000372='','0',kpi_0000000372) as double ),0) as kpi_0000000372,
    coalesce(cast (if(kpi_0000000376='','0',kpi_0000000376) as double ),0) as kpi_0000000376,
    coalesce(cast (if(kpi_0000000381='','0',kpi_0000000381) as double ),0) as kpi_0000000381,
    coalesce(cast (if(kpi_0000000383='','0',kpi_0000000383) as double ),0) as kpi_0000000383,
    coalesce(cast (if(kpi_0000000385='','0',kpi_0000000385) as double ),0) as kpi_0000000385,
    coalesce(cast (if(kpi_0000000386='','0',kpi_0000000386) as double ),0) as kpi_0000000386,
    coalesce(cast (if(kpi_0000000390='','0',kpi_0000000390) as double ),0) as kpi_0000000390,
    coalesce(cast (if(kpi_0000000395='','0',kpi_0000000395) as double ),0) as kpi_0000000395,
    coalesce(cast (if(kpi_0000000395_1='','0',kpi_0000000395_1) as double ),0) as kpi_0000000395_1,
    coalesce(cast (if(kpi_0000000395_5='','0',kpi_0000000395_5) as double ),0) as kpi_0000000395_5,
    coalesce(cast (if(kpi_0000000396='','0',kpi_0000000396) as double ),0) as kpi_0000000396,
    coalesce(cast (if(kpi_0000000396_1='','0',kpi_0000000396_1) as double ),0) as kpi_0000000396_1,
    coalesce(cast (if(kpi_0000000396_5='','0',kpi_0000000396_5) as double ),0) as kpi_0000000396_5,
    coalesce(cast (if(kpi_0000000397='','0',kpi_0000000397) as double ),0) as kpi_0000000397,
    coalesce(cast (if(kpi_0000000401='','0',kpi_0000000401) as double ),0) as kpi_0000000401,
    coalesce(cast (if(kpi_0000000406='','0',kpi_0000000406) as double ),0) as kpi_0000000406,
    coalesce(cast (if(kpi_0000000406_1='','0',kpi_0000000406_1) as double ),0) as kpi_0000000406_1,
    coalesce(cast (if(kpi_0000000406_5='','0',kpi_0000000406_5) as double ),0) as kpi_0000000406_5,
    coalesce(cast (if(kpi_0000000475='','0',kpi_0000000475) as double ),0) as kpi_0000000475,
    coalesce(cast (if(kpi_0000000476='','0',kpi_0000000476) as double ),0) as kpi_0000000476,
    coalesce(cast (if(kpi_0000000477='','0',kpi_0000000477) as double ),0) as kpi_0000000477,
    coalesce(cast (if(kpi_0000000480='','0',kpi_0000000480) as double ),0) as kpi_0000000480,
    coalesce(cast (if(kpi_0000000483='','0',kpi_0000000483) as double ),0) as kpi_0000000483,
    coalesce(cast (if(kpi_0000000486='','0',kpi_0000000486) as double ),0) as kpi_0000000486,
    coalesce(cast (if(kpi_0000000487='','0',kpi_0000000487) as double ),0) as kpi_0000000487,
    coalesce(cast (if(kpi_0000000490='','0',kpi_0000000490) as double ),0) as kpi_0000000490,
    coalesce(cast (if(kpi_0000000493='','0',kpi_0000000493) as double ),0) as kpi_0000000493,
    coalesce(cast (if(kpi_0000000496='','0',kpi_0000000496) as double ),0) as kpi_0000000496,
    coalesce(cast (if(kpi_0000000497='','0',kpi_0000000497) as double ),0) as kpi_0000000497,
    coalesce(cast (if(kpi_0000000498='','0',kpi_0000000498) as double ),0) as kpi_0000000498,
    coalesce(cast (if(kpi_0000000508='','0',kpi_0000000508) as double ),0) as kpi_0000000508,
    coalesce(cast (if(kpi_0000000518='','0',kpi_0000000518) as double ),0) as kpi_0000000518,
    coalesce(cast (if(kpi_0000000518_1='','0',kpi_0000000518_1) as double ),0) as kpi_0000000518_1,
    coalesce(cast (if(kpi_0000000518_5='','0',kpi_0000000518_5) as double ),0) as kpi_0000000518_5,
    coalesce(cast (if(kpi_0000000519='','0',kpi_0000000519) as double ),0) as kpi_0000000519,
    coalesce(cast (if(kpi_0000000522='','0',kpi_0000000522) as double ),0) as kpi_0000000522,
    coalesce(cast (if(kpi_0000000523='','0',kpi_0000000523) as double ),0) as kpi_0000000523,
    coalesce(cast (if(kpi_0000000524='','0',kpi_0000000524) as double ),0) as kpi_0000000524,
    coalesce(cast (if(kpi_0000000543='','0',kpi_0000000543) as double ),0) as kpi_0000000543,
    coalesce(cast (if(kpi_0000000543_1='','0',kpi_0000000543_1) as double ),0) as kpi_0000000543_1,
    coalesce(cast (if(kpi_0000000543_5='','0',kpi_0000000543_5) as double ),0) as kpi_0000000543_5,
    coalesce(cast (if(kpi_0000000544='','0',kpi_0000000544) as double ),0) as kpi_0000000544,
    coalesce(cast (if(kpi_0000000545='','0',kpi_0000000545) as double ),0) as kpi_0000000545,
    coalesce(cast (if(kpi_0000000546='','0',kpi_0000000546) as double ),0) as kpi_0000000546,
    coalesce(cast (if(kpi_0000000547='','0',kpi_0000000547) as double ),0) as kpi_0000000547,
    coalesce(cast (if(kpi_0000000547_1='','0',kpi_0000000547_1) as double ),0) as kpi_0000000547_1,
    coalesce(cast (if(kpi_0000000547_5='','0',kpi_0000000547_5) as double ),0) as kpi_0000000547_5,
    coalesce(cast (if(kpi_0000000551='','0',kpi_0000000551) as double ),0) as kpi_0000000551,
    coalesce(cast (if(kpi_0000000551_k='','0',kpi_0000000551_k) as double ),0) as kpi_0000000551_k,
    coalesce(cast (if(kpi_0000000552='','0',kpi_0000000552) as double ),0) as kpi_0000000552,
    coalesce(cast (if(kpi_0000000553='','0',kpi_0000000553) as double ),0) as kpi_0000000553,
    coalesce(cast (if(kpi_0000000554='','0',kpi_0000000554) as double ),0) as kpi_0000000554,
    coalesce(cast (if(kpi_0000000555='','0',kpi_0000000555) as double ),0) as kpi_0000000555,
    coalesce(cast (if(kpi_0000000556='','0',kpi_0000000556) as double ),0) as kpi_0000000556,
    coalesce(cast (if(kpi_0000000557='','0',kpi_0000000557) as double ),0) as kpi_0000000557,
    coalesce(cast (if(kpi_0000000558='','0',kpi_0000000558) as double ),0) as kpi_0000000558,
    coalesce(cast (if(kpi_0000000559='','0',kpi_0000000559) as double ),0) as kpi_0000000559,
    coalesce(cast (if(kpi_0000000560='','0',kpi_0000000560) as double ),0) as kpi_0000000560,
    coalesce(cast (if(kpi_0000000577='','0',kpi_0000000577) as double ),0) as kpi_0000000577,
    coalesce(cast (if(kpi_0000000578='','0',kpi_0000000578) as double ),0) as kpi_0000000578,
    coalesce(cast (if(kpi_0000000579='','0',kpi_0000000579) as double ),0) as kpi_0000000579,
    coalesce(cast (if(kpi_0000000582='','0',kpi_0000000582) as double ),0) as kpi_0000000582,
    coalesce(cast (if(kpi_0000000583='','0',kpi_0000000583) as double ),0) as kpi_0000000583,
    coalesce(cast (if(kpi_0000000584='','0',kpi_0000000584) as double ),0) as kpi_0000000584,
    coalesce(cast (if(kpi_0000000585='','0',kpi_0000000585) as double ),0) as kpi_0000000585,
    coalesce(cast (if(kpi_0000000585_k='','0',kpi_0000000585_k) as double ),0) as kpi_0000000585_k,
    coalesce(cast (if(kpi_0000000586='','0',kpi_0000000586) as double ),0) as kpi_0000000586,
    coalesce(cast (if(kpi_0000000587='','0',kpi_0000000587) as double ),0) as kpi_0000000587,
    coalesce(cast (if(kpi_0000000588='','0',kpi_0000000588) as double ),0) as kpi_0000000588,
    coalesce(cast (if(kpi_0000000589='','0',kpi_0000000589) as double ),0) as kpi_0000000589,
    coalesce(cast (if(kpi_0000000590='','0',kpi_0000000590) as double ),0) as kpi_0000000590,
    coalesce(cast (if(kpi_0000000591='','0',kpi_0000000591) as double ),0) as kpi_0000000591,
    coalesce(cast (if(kpi_0000000592='','0',kpi_0000000592) as double ),0) as kpi_0000000592,
    coalesce(cast (if(kpi_0000000595='','0',kpi_0000000595) as double ),0) as kpi_0000000595,
    coalesce(cast (if(kpi_0000000596='','0',kpi_0000000596) as double ),0) as kpi_0000000596,
    coalesce(cast (if(kpi_0000000597='','0',kpi_0000000597) as double ),0) as kpi_0000000597,
    coalesce(cast (if(kpi_0000000598='','0',kpi_0000000598) as double ),0) as kpi_0000000598,
    coalesce(cast (if(kpi_0000000599='','0',kpi_0000000599) as double ),0) as kpi_0000000599,
    coalesce(cast (if(kpi_0000000600='','0',kpi_0000000600) as double ),0) as kpi_0000000600,
    coalesce(cast (if(kpi_0000000601='','0',kpi_0000000601) as double ),0) as kpi_0000000601,
    coalesce(cast (if(kpi_0000000602='','0',kpi_0000000602) as double ),0) as kpi_0000000602,
    coalesce(cast (if(kpi_0000000603='','0',kpi_0000000603) as double ),0) as kpi_0000000603,
    coalesce(cast (if(kpi_0000000604='','0',kpi_0000000604) as double ),0) as kpi_0000000604,
    coalesce(cast (if(kpi_0000000605='','0',kpi_0000000605) as double ),0) as kpi_0000000605,
    coalesce(cast (if(kpi_0000000606='','0',kpi_0000000606) as double ),0) as kpi_0000000606,
    coalesce(cast (if(kpi_0000000607='','0',kpi_0000000607) as double ),0) as kpi_0000000607,
    coalesce(cast (if(kpi_0000000608='','0',kpi_0000000608) as double ),0) as kpi_0000000608,
    coalesce(cast (if(kpi_0000000609='','0',kpi_0000000609) as double ),0) as kpi_0000000609,
    coalesce(cast (if(kpi_0000000610='','0',kpi_0000000610) as double ),0) as kpi_0000000610,
    coalesce(cast (if(kpi_0000000611='','0',kpi_0000000611) as double ),0) as kpi_0000000611,
    coalesce(cast (if(kpi_0000000612='','0',kpi_0000000612) as double ),0) as kpi_0000000612,
    coalesce(cast (if(kpi_0000000613='','0',kpi_0000000613) as double ),0) as kpi_0000000613,
    coalesce(cast (if(kpi_0000000614='','0',kpi_0000000614) as double ),0) as kpi_0000000614,
    coalesce(cast (if(kpi_0000000615='','0',kpi_0000000615) as double ),0) as kpi_0000000615,
    coalesce(cast (if(kpi_0000000616='','0',kpi_0000000616) as double ),0) as kpi_0000000616,
    coalesce(cast (if(kpi_0000000617='','0',kpi_0000000617) as double ),0) as kpi_0000000617,
    coalesce(cast (if(kpi_0000000617_cu='','0',kpi_0000000617_cu) as double ),0) as kpi_0000000617_cu,
    coalesce(cast (if(kpi_0000000617_du='','0',kpi_0000000617_du) as double ),0) as kpi_0000000617_du,
    coalesce(cast (if(kpi_0000000617_uu='','0',kpi_0000000617_uu) as double ),0) as kpi_0000000617_uu,
    coalesce(cast (if(kpi_0000000618='','0',kpi_0000000618) as double ),0) as kpi_0000000618,
    coalesce(cast (if(kpi_0000000619='','0',kpi_0000000619) as double ),0) as kpi_0000000619,
    coalesce(cast (if(kpi_0000000620='','0',kpi_0000000620) as double ),0) as kpi_0000000620,
    coalesce(cast (if(kpi_0000000623='','0',kpi_0000000623) as double ),0) as kpi_0000000623,
    coalesce(cast (if(kpi_0000000624='','0',kpi_0000000624) as double ),0) as kpi_0000000624,
    coalesce(cast (if(kpi_0000000625='','0',kpi_0000000625) as double ),0) as kpi_0000000625,
    coalesce(cast (if(kpi_0000000625_m='','0',kpi_0000000625_m) as double ),0) as kpi_0000000625_m,
    coalesce(cast (if(kpi_0000000625_s='','0',kpi_0000000625_s) as double ),0) as kpi_0000000625_s,
    coalesce(cast (if(kpi_0000000626='','0',kpi_0000000626) as double ),0) as kpi_0000000626,
    coalesce(cast (if(kpi_0000000627='','0',kpi_0000000627) as double ),0) as kpi_0000000627,
    coalesce(cast (if(kpi_0000000628='','0',kpi_0000000628) as double ),0) as kpi_0000000628,
    coalesce(cast (if(kpi_0000000629='','0',kpi_0000000629) as double ),0) as kpi_0000000629,
    coalesce(cast (if(kpi_0000000630='','0',kpi_0000000630) as double ),0) as kpi_0000000630,
    coalesce(cast (if(kpi_0000000631='','0',kpi_0000000631) as double ),0) as kpi_0000000631,
    coalesce(cast (if(kpi_0000000652='','0',kpi_0000000652) as double ),0) as kpi_0000000652,
    coalesce(cast (if(kpi_0000000653='','0',kpi_0000000653) as double ),0) as kpi_0000000653,
    coalesce(cast (if(kpi_0000000654='','0',kpi_0000000654) as double ),0) as kpi_0000000654,
    coalesce(cast (if(kpi_0000000655='','0',kpi_0000000655) as double ),0) as kpi_0000000655,
    coalesce(cast (if(kpi_0000000684='','0',kpi_0000000684) as double ),0) as kpi_0000000684,
    coalesce(cast (if(kpi_0000000685='','0',kpi_0000000685) as double ),0) as kpi_0000000685,
    coalesce(cast (if(kpi_0000000686='','0',kpi_0000000686) as double ),0) as kpi_0000000686,
    coalesce(cast (if(kpi_0000000687='','0',kpi_0000000687) as double ),0) as kpi_0000000687,
    (cast (kPI_0000000422 as double)+cast (kPI_0000000423 as double)+cast (kPI_0000000424 as double)+cast (kPI_0000000425 as double)+cast (kPI_0000000426 as double)+cast (kPI_0000000427 as double)+cast (kPI_0000000428 as double)+cast (kPI_0000000429 as double)+cast (kPI_0000000430 as double)+cast (kPI_0000000431 as double)+cast (kPI_0000000432 as double)+cast (kPI_0000000433 as double)+cast (kPI_0000000434 as double)+cast (kPI_0000000435 as double)+cast (kPI_0000000436 as double)+cast (kPI_0000000437 as double)+cast (kPI_0000000438 as double)+cast (kPI_0000000439 as double)+cast (kPI_0000000440 as double)+cast (kPI_0000000441 as double)+cast (kPI_0000000442 as double))/if((cast (kPI_0000000411 as double)+cast (kPI_0000000412 as double)+cast (kPI_0000000413 as double)+cast (kPI_0000000414 as double)+cast (kPI_0000000415 as double)+cast (kPI_0000000416 as double)+cast (kPI_0000000417 as double)+cast (kPI_0000000418 as double)+cast (kPI_0000000419 as double)+cast (kPI_0000000420 as double)+cast (kPI_0000000421 as double)+cast (kPI_0000000422 as double)+cast (kPI_0000000423 as double)+cast (kPI_0000000424 as double)+cast (kPI_0000000425 as double)+cast (kPI_0000000426 as double)+cast (kPI_0000000427 as double)+cast (kPI_0000000428 as double)+cast (kPI_0000000429 as double)+cast (kPI_0000000430 as double)+cast (kPI_0000000431 as double)+cast (kPI_0000000432 as double)+cast (kPI_0000000433 as double)+cast (kPI_0000000434 as double)+cast (kPI_0000000435 as double)+cast (kPI_0000000436 as double)+cast (kPI_0000000437 as double)+cast (kPI_0000000438 as double)+cast (kPI_0000000439 as double)+cast (kPI_0000000440 as double)+cast (kPI_0000000441 as double)+cast (kPI_0000000442 as double))=0,1.0,(cast (kPI_0000000411 as double)+cast (kPI_0000000412 as double)+cast (kPI_0000000413 as double)+cast (kPI_0000000414 as double)+cast (kPI_0000000415 as double)+cast (kPI_0000000416 as double)+cast (kPI_0000000417 as double)+cast (kPI_0000000418 as double)+cast (kPI_0000000419 as double)+cast (kPI_0000000420 as double)+cast (kPI_0000000421 as double)+cast (kPI_0000000422 as double)+cast (kPI_0000000423 as double)+cast (kPI_0000000424 as double)+cast (kPI_0000000425 as double)+cast (kPI_0000000426 as double)+cast (kPI_0000000427 as double)+cast (kPI_0000000428 as double)+cast (kPI_0000000429 as double)+cast (kPI_0000000430 as double)+cast (kPI_0000000431 as double)+cast (kPI_0000000432 as double)+cast (kPI_0000000433 as double)+cast (kPI_0000000434 as double)+cast (kPI_0000000435 as double)+cast (kPI_0000000436 as double)+cast (kPI_0000000437 as double)+cast (kPI_0000000438 as double)+cast (kPI_0000000439 as double)+cast (kPI_0000000440 as double)+cast (kPI_0000000441 as double)+cast (kPI_0000000442 as double))) as pusch_mcsge11_ratio,
    (cast (kPI_0000000454 as double)+cast (kPI_0000000455 as double)+cast (kPI_0000000456 as double)+cast (kPI_0000000457 as double)+cast (kPI_0000000458 as double)+cast (kPI_0000000459 as double)+cast (kPI_0000000460 as double)+cast (kPI_0000000461 as double)+cast (kPI_0000000462 as double)+cast (kPI_0000000463 as double)+cast (kPI_0000000464 as double)+cast (kPI_0000000465 as double)+cast (kPI_0000000466 as double)+cast (kPI_0000000467 as double)+cast (kPI_0000000468 as double)+cast (kPI_0000000469 as double)+cast (kPI_0000000470 as double)+cast (kPI_0000000471 as double)+cast (kPI_0000000472 as double)+cast (kPI_0000000473 as double)+cast (kPI_0000000474 as double))/if((cast (kPI_0000000443 as double)+cast (kPI_0000000444 as double)+cast (kPI_0000000445 as double)+cast (kPI_0000000446 as double)+cast (kPI_0000000447 as double)+cast (kPI_0000000448 as double)+cast (kPI_0000000449 as double)+cast (kPI_0000000450 as double)+cast (kPI_0000000451 as double)+cast (kPI_0000000452 as double)+cast (kPI_0000000453 as double)+cast (kPI_0000000454 as double)+cast (kPI_0000000455 as double)+cast (kPI_0000000456 as double)+cast (kPI_0000000457 as double)+cast (kPI_0000000458 as double)+cast (kPI_0000000459 as double)+cast (kPI_0000000460 as double)+cast (kPI_0000000461 as double)+cast (kPI_0000000462 as double)+cast (kPI_0000000463 as double)+cast (kPI_0000000464 as double)+cast (kPI_0000000465 as double)+cast (kPI_0000000466 as double)+cast (kPI_0000000467 as double)+cast (kPI_0000000468 as double)+cast (kPI_0000000469 as double)+cast (kPI_0000000470 as double)+cast (kPI_0000000471 as double)+cast (kPI_0000000472 as double)+cast (kPI_0000000473 as double)+cast (kPI_0000000474 as double))=0,1.0,(cast (kPI_0000000443 as double)+cast (kPI_0000000444 as double)+cast (kPI_0000000445 as double)+cast (kPI_0000000446 as double)+cast (kPI_0000000447 as double)+cast (kPI_0000000448 as double)+cast (kPI_0000000449 as double)+cast (kPI_0000000450 as double)+cast (kPI_0000000451 as double)+cast (kPI_0000000452 as double)+cast (kPI_0000000453 as double)+cast (kPI_0000000454 as double)+cast (kPI_0000000455 as double)+cast (kPI_0000000456 as double)+cast (kPI_0000000457 as double)+cast (kPI_0000000458 as double)+cast (kPI_0000000459 as double)+cast (kPI_0000000460 as double)+cast (kPI_0000000461 as double)+cast (kPI_0000000462 as double)+cast (kPI_0000000463 as double)+cast (kPI_0000000464 as double)+cast (kPI_0000000465 as double)+cast (kPI_0000000466 as double)+cast (kPI_0000000467 as double)+cast (kPI_0000000468 as double)+cast (kPI_0000000469 as double)+cast (kPI_0000000470 as double)+cast (kPI_0000000471 as double)+cast (kPI_0000000472 as double)+cast (kPI_0000000473 as double)+cast (kPI_0000000474 as double))) as pdsch_mcsge11_ratio,
    (cast (kPI_0000000643 as double)+cast (kPI_0000000644 as double)+cast (kPI_0000000645 as double)+cast (kPI_0000000646 as double)+cast (kPI_0000000647 as double)+cast (kPI_0000000648 as double)+cast (kPI_0000000649 as double)+cast (kPI_0000000650 as double)+cast (kPI_0000000651 as double))/if((cast (kPI_0000000636 as double)+cast (kPI_0000000637 as double)+cast (kPI_0000000638 as double)+cast (kPI_0000000639 as double)+cast (kPI_0000000640 as double)+cast (kPI_0000000641 as double)+cast (kPI_0000000642 as double)+cast (kPI_0000000643 as double)+cast (kPI_0000000644 as double)+cast (kPI_0000000645 as double)+cast (kPI_0000000646 as double)+cast (kPI_0000000647 as double)+cast (kPI_0000000648 as double)+cast (kPI_0000000649 as double)+cast (kPI_0000000650 as double)+cast (kPI_0000000651 as double))=0,1.0, (cast (kPI_0000000636 as double)+cast (kPI_0000000637 as double)+cast (kPI_0000000638 as double)+cast (kPI_0000000639 as double)+cast (kPI_0000000640 as double)+cast (kPI_0000000641 as double)+cast (kPI_0000000642 as double)+cast (kPI_0000000643 as double)+cast (kPI_0000000644 as double)+cast (kPI_0000000645 as double)+cast (kPI_0000000646 as double)+cast (kPI_0000000647 as double)+cast (kPI_0000000648 as double)+cast (kPI_0000000649 as double)+cast (kPI_0000000650 as double)+cast (kPI_0000000651 as double))) as  cqig7_ratio
from hive.cnio.pm_4g where city_id='12501' '''
    data = trino_execute(conn,sql_hour)
    postgre_expert(data)
    print("success")